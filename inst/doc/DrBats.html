<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="(see list of authors below)" />

<meta name="date" content="2022-02-02" />

<title>DrBats Project</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">DrBats Project</h1>
<h4 class="author">(see list of authors below)</h4>
<h4 class="date">2022-02-02</h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This document is part of the “DrBats” project whose goal is to implement exploratory statistical analysis on large sets of data with uncertainty. The idea is to visualize the results of the analysis in a way that explicitely illustrates the uncertainty in the data.</p>
<p>The “DrBats” project applies a Bayesian Latent Factor Model.</p>
<p>This project involves the following persons, listed in alphabetical order :</p>
<ul>
<li><p>Bénédicte Fontez (aut)</p></li>
<li><p>Nadine Hilgert (aut)</p></li>
<li><p>Susan Holmes (aut)</p></li>
<li><p><strong>Gabrielle Weinrott</strong> (cre, aut)</p></li>
</ul>
</div>
<div id="bayesian-latent-factor-model" class="section level1">
<h1>Bayesian Latent Factor Model</h1>
<div id="notations" class="section level2">
<h2>Notations</h2>
<ul>
<li><p><span class="math inline">\(\mathbf{Y}\)</span> : observed response variable, <span class="math inline">\(y_1\)</span>, …, <span class="math inline">\(y_i\)</span>, …, <span class="math inline">\(y_N\)</span> are the rows each of length <span class="math inline">\(P\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{W}\)</span> : is a low-rank matrix, with <span class="math inline">\(W_1\)</span>, …, <span class="math inline">\(W_D\)</span> columns of length <span class="math inline">\(P\)</span>, <span class="math inline">\(D \leq P\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{\beta}\)</span> : a <span class="math inline">\(D \times N\)</span> matrix of factor loadings, and <span class="math inline">\(\beta_i\)</span> are the factor loadings of the <span class="math inline">\(i^{th}\)</span> individual observed</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> : the <span class="math inline">\(P \times N\)</span> matrix of errors, with precision <span class="math inline">\(\sigma^2\)</span></p></li>
</ul>
<p>We want to visualize <span class="math inline">\(\mathbf{Y}\)</span> in a lower dimension. The <span class="math inline">\(\mathbf{\beta}\)</span> are the coordinates of the observations in the lower dimension, <span class="math inline">\(\mathbf{W}\)</span> is the transition matrix, and <span class="math inline">\(\epsilon\)</span> represents the difference between the low-rank represenation and the actual data.</p>
</div>
<div id="model" class="section level2">
<h2>Model</h2>
<p>Without loss of generality, we assume that <span class="math inline">\(\mathbf{Y}\)</span> is centered. The Latent Factor Model is therefore:</p>
<p><span class="math inline">\(\mathbf{Y_i}^T = \mathbf{W}\beta_i + \epsilon_i\)</span></p>
<p>For identifiability reasons, we will estimate a <span class="math inline">\(P \times D\)</span> positive lower triangular (PLT) matrix, instead of the full matrix <span class="math inline">\(\mathbf{W}\)</span>. We can do a matrix decomposition of <span class="math inline">\(\mathbf{W}\)</span> as an orthogonal matrix and an upper-triangular matrix, <span class="math inline">\(\mathbf{W} = \mathbf{Q} \mathbf{R}\)</span>. As such, we estimate the PLT matrix <span class="math inline">\(\mathbf{R}^T = \left(r_{j, k}\right)_{j = 1:P, k = 1:D}\)</span> with the rotation matrix <span class="math inline">\(\mathbf{Q}\)</span> known (for instance, estimated from the classical PCA):</p>
<p><span class="math display">\[ \mathbf{R}^T = \begin{pmatrix}
    r_{1, 1} &amp; 0 &amp; \cdots &amp;  0\\
    r_{2, 1} &amp; r_{2, 2} &amp; \ddots &amp; 0 \\
    r_{3, 1} &amp; r_{3, 2} &amp; \ddots &amp;  \vdots \\
    \vdots &amp;  &amp; \ddots &amp; r_{P, D}
    \end{pmatrix} \]</span></p>
<p>We assume for now that all rows of <span class="math inline">\(\mathbf{Y}\)</span> have the same variance, that is <span class="math inline">\(\sigma^2 \mathbf{1}_P\)</span>. The full Bayesian model is:</p>
<p><span class="math display">\[\begin{eqnarray}\label{model}
\mathbf{Y_i}^T|\mathbf{R}^T, \beta_i, \sigma^2 &amp;\overset{i.i.d.}{\sim}&amp;  \mathcal{N}_P(\mathbf{R}^T\beta_i, \sigma^2 \mathbf{1}_P)
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
\beta_i &amp; \overset{i.i.d.}{\sim}&amp; \mathcal{N}_D(0, \mathbf{1}_D) \\
r_{j, k} &amp; \overset{i.i.d.}{\sim}&amp; \mathcal{N}(0, \tau^2) \\
\sigma^2, \tau^2 &amp;\sim&amp; IG(0.001, 0.001)
\end{eqnarray*}\]</span></p>
<p>We assume that the non-null entries of the PLT matrix are independent, centered and normal, with same variance <span class="math inline">\(\tau^2\)</span>.</p>
<p>To integrate information about uncertainty for interval-valued data, we can put an informative prior on the variance of each individual <span class="math inline">\(\mathbf{Y_i}\)</span>. This could be in the form of a weight matrix, for instance <span class="math inline">\(\sigma^2 \Phi_i\)</span> where <span class="math inline">\(\Phi_i\)</span> is either fixed by the user, or estimated.</p>
<p>Finally, contrary to classical Principal Component Analysis, in this model the factor loadings <span class="math inline">\(\beta_i\)</span> for each individual are random variables. This allows for uncertainty of projection, resulting in non-elliptical confidence regions around the estimated factor loadings.</p>
</div>
</div>
<div id="data-simulation" class="section level1">
<h1>Data Simulation</h1>
<p>We can simulate data using <span class="math inline">\(\mathbf{Y_i}^T = \mathbf{R}^T\beta_i + \epsilon_i\)</span> with the function <code>drbats.simul()</code>. We choose a matrix <span class="math inline">\(\mathbf{R}\)</span>, and then build <span class="math inline">\(\mathbf{Y_i}\)</span> by simulating <span class="math inline">\(\beta_i\)</span> and <span class="math inline">\(\epsilon_i\)</span> for each individual. To obtain the full matrix <span class="math inline">\(\mathbf{Y}\)</span>, we stack the rows <span class="math inline">\(\mathbf{Y_i}\)</span>.</p>
<p>The matrix <span class="math inline">\(\mathbf{R}\)</span> built in this package is, as previously stated, the result of the matrix decomposition of a full low-rank matrix <span class="math inline">\(\mathbf{W}\)</span>. To choose an <span class="math inline">\(\mathbf{R}\)</span> that would resemble something out of an agronomic dataset, we build <span class="math inline">\(\mathbf{W}\)</span> to be the low-rank matrix of an extreme case of data found in agronomy: often times observations are signals that trend over time, with peaks at certain moments over the observation period. In addition, the number of observations can be small when these peaks occur.</p>
<p>To build <span class="math inline">\(\mathbf{W}\)</span> and subsequently, <span class="math inline">\(\mathbf{R}\)</span>, we first simulate bi-modal signals observed unevenly over time.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">require</span>(DrBats))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">=</span> <span class="dv">45</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>toydata <span class="ot">&lt;-</span> <span class="fu">drbats.simul</span>(<span class="at">N =</span> <span class="dv">5</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">P =</span> <span class="dv">150</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">t.range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">b.range =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">c.range =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">b.sd =</span> <span class="dv">5</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">c.sd =</span> <span class="dv">5</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sigma2 =</span> <span class="fl">0.2</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">breaks =</span> <span class="dv">8</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data.type =</span> <span class="st">&#39;sparse.tend&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">t</span>(toydata<span class="sc">$</span>t), <span class="fu">t</span>(toydata<span class="sc">$</span>X), <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39; &#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">t</span>(toydata<span class="sc">$</span>t), <span class="fu">t</span>(toydata<span class="sc">$</span>X), <span class="at">pch =</span> <span class="st">&#39;.&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>For details please refer to the <code>simul_and_project.pdf</code> vignette.</em></p>
<p>We set the dimensionality of the low-rank matrix as the number of axes retained after Principal Component Analysis:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(toydata<span class="sc">$</span>proj.pca<span class="sc">$</span>lambda.perc, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> mycol[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(toydata<span class="sc">$</span>proj.pca<span class="sc">$</span>lambda.perc)])</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOjoAOpAAZrYcrHgfdf46AAA6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrb///uIE3/tmb/25D//7b//9v///9uaTyzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADlklEQVR4nO3dwXLTBgBFUVFKC2kAQ0j8/39akxCGji1di6iJI527YMHijX1GyNZYGoa9Jhte+gVceoAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFC0DNDws0XmLqmF3xGg5527gABFgCJAEaAIUAQoAhQBigBF897Rp2F4d3d9uOT6Z5G519Csd7T788vB6N1+f3v1YWpuONWTX+rLNOd1310fWG7efNw/UI3PDV+P2wLQ7dXhX9bNH5/3j3+OzW0VyBFU/TwH3VONz20W6NxPse0CnTkHKOYA7Xc+xeat/PfrIKCYAxRz2wW6/4g/NHIG2jzQbvjx/fBm8EXxRL98f3apcar7i9WHXKyeyhFU7R6vwZyDRrq9evgUGzl+AJ05ByjmAMUcoJgDFHOAYg5QzAGKOUAxByjmAMUcoJgDFHOAjlb87DNrDlDMAYo5QDEHKOYAxRygmAMUc4BiDlDMAYq5rQN9ez92F/DGgR5/eJ64hWrbQI/3LDiCRru9+n7bAqCJPr35CGiy3fAB0GTf3r8FNNnd9ejDPoDOmwPkYZa5K37VmDUHKOa2C+Rhluk8zDKdRxEiD7NEjqDKwyyVh1mWmQMUc4BiDlDMAYo5QDEHKOYAxRygmAMUc4BiDlDMATpa8avGrDlAMQco5gDFHKCYAxRzgGIOUMwBijlAMQco5gDF3HaB3B803RPvD3qV/1/Lc97dMfx91LqAnnp/0OqBHEHVE+8PGgG67FPTc94fNAb011GvFujMOUAxB+j3HmaZB3Qhp6b/52ef029u5C2/wF8/O9CKAxQtfLG6vha+WF1fC19qrK+FL1bXlyMoWvhidX0tfLG6vnwPigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhT9C7K0o2oPXR/zAAAAAElFTkSuQmCC" /><!-- --></p>
<pre><code>## [1] &quot;Number of retained axes: 2&quot;</code></pre>
<p>If you want to use the PCA rotation to anchor the latent factors, the function <code>wlu()</code> does an LU matrix decomposition of the matrix of latent factors.</p>
</div>
<div id="model-inference" class="section level1">
<h1>Model Inference</h1>
<p>Now we fit a <a href="https://mc-stan.org/">Stan</a> model for the simulated data with a <a href="https://arxiv.org/pdf/1111.4246v1.pdf">No-U-Turn Sampler</a> using the <code>modelFit()</code> function, and the <a href="https://cran.r-project.org/package=rstan">rstan</a> package.</p>
<p>See the <code>modelFit.pdf</code> vignette for details.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">modelFit</span>(<span class="at">model =</span> <span class="st">&quot;PLT&quot;</span>, <span class="at">var.prior =</span> <span class="st">&quot;IG&quot;</span>, <span class="at">prog =</span> <span class="st">&quot;stan&quot;</span>, <span class="at">Xhisto =</span> toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">nchains =</span> <span class="dv">4</span>, <span class="at">nthin =</span> <span class="dv">50</span>, <span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">D =</span> toydata<span class="sc">$</span>wlu<span class="sc">$</span>D)</span></code></pre></div>
<p>The <code>main.modelFit()</code> function outputs an object called <code>fit</code>, containing the posterior estimates for the parameters of the model.</p>
</div>
<div id="evaluation" class="section level1">
<h1>Evaluation</h1>
<p>For evaluation, we can convert the object to an <code>mcmc.list</code> to apply the diagnostic tests in <a href="https://CRAN.R-project.org/package=coda/coda.pdf">the coda package manual</a>. Our package also works on <code>mcmc.lists</code> for coherence.</p>
<p>We can plot the histogram of the posterior density of the data:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">postdens</span>(codafit, <span class="at">Y =</span> toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y, <span class="at">D =</span> toydata<span class="sc">$</span>wlu<span class="sc">$</span>D, <span class="at">chain =</span> <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(post, <span class="at">main =</span> <span class="st">&quot;Histogram of the posterior density&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It’s possible to visualize the projection of the observations onto the lower dimensional space with the function <span class="math inline">\(visbeta()\)</span>. We can project onto the latent factors of our choice, here we chose the first and second (we didn’t have a choice actually since there are only two latent factors in the toy example). The uncertainty envelope at <span class="math inline">\(95 \%\)</span> is also plotted if we choose <span class="math inline">\(quant = c(0.05, 0.95)\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>beta.res <span class="ot">&lt;-</span> <span class="fu">visbeta</span>(codafit, toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y, toydata<span class="sc">$</span>wlu<span class="sc">$</span>D, <span class="at">chain =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">quant =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_path</span>(<span class="at">data =</span> beta.res<span class="sc">$</span>contour.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> ind)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> beta.res<span class="sc">$</span>mean.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> ind)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a> ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Convex hull of Score Estimates&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>W.res <span class="ot">&lt;-</span> <span class="fu">visW</span>(codafit, toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y, toydata<span class="sc">$</span>wlu<span class="sc">$</span>D, <span class="at">chain =</span> <span class="dv">1</span>, <span class="at">factors =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>W.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, W.res<span class="sc">$</span>res.W)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_step</span>(<span class="at">data =</span> W.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Estimation, <span class="at">colour =</span> Factor)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_step</span>(<span class="at">data =</span> W.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Lower.est, <span class="at">colour =</span> Factor), <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_step</span>(<span class="at">data =</span> W.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Upper.est, <span class="at">colour =</span> Factor), <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Latent Factor Estimations&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>G. Weinrott, B. Fontez, N. Hilgert &amp; S. Holmes, “Modèle Bayésien à facteurs latents pour l’analyse de données fonctionnelles”, Actes des JdS 2016.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
