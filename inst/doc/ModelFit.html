<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="(see list of authors below)" />

<meta name="date" content="2022-02-02" />

<title>DrBats Model Fit</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">DrBats Model Fit</h1>
<h4 class="author">(see list of authors below)</h4>
<h4 class="date">2022-02-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This document is part of the “DrBats” project whose goal is to implement exploratory statistical analysis on large sets of data with uncertainty. The idea is to visualize the results of the analysis in a way that explicitely illustrates the uncertainty in the data.</p>
<p>The “DrBats” project applies a Bayesian Latent Factor Model.</p>
<p>This project involves the following persons, listed in alphabetical order :</p>
<ul>
<li><p>Bénédicte Fontez (aut)</p></li>
<li><p>Nadine Hilgert (aut)</p></li>
<li><p>Susan Holmes (aut)</p></li>
<li><p><strong>Gabrielle Weinrott</strong> (cre, aut)</p></li>
</ul>
</div>
<div id="fitting-the-model-to-simulated-data" class="section level2">
<h2>Fitting the model to simulated data</h2>
<p>First, let’s load the package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(DrBats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mycol<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;#ee204d&quot;</span>, <span class="st">&quot;#1f75fe&quot;</span>, <span class="st">&quot;#1cac78&quot;</span>, <span class="st">&quot;#ff7538&quot;</span>, <span class="st">&quot;#b4674d&quot;</span>, <span class="st">&quot;#926eae&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;#fce883&quot;</span>, <span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#78dbe2&quot;</span>, <span class="st">&quot;#6e5160&quot;</span>, <span class="st">&quot;#ff43a4&quot;</span>)</span></code></pre></div>
<p>To fit the model, you need to specify a bunch of parameters: the type of model (“PLT” or “sparse”), the family of variance priors (“IG” or “cauchy” for now), the program you want to use (only “stan” is implemented for the time being), a dataset projected onto a histogram basis, the number of latent factors (“D”), and then some other habitual MCMC things (iterations, thinning, burnin).</p>
<p>Then you can execute the <code>modelFit()</code> function with the chosen parameters. STAN calculations can be long, so the following example is intentionally very small, with few iterations and few chains on the toy dataset.</p>
<p>If you want to estimate many parameteres and require a large number of iterations, you may want to consider running the following commands on a server or a desktop machine.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;toydata&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>proj.data <span class="ot">&lt;-</span> toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> <span class="fu">modelFit</span>(<span class="at">model =</span> <span class="st">&quot;PLT&quot;</span>, <span class="at">var.prior =</span> <span class="st">&quot;IG&quot;</span>, <span class="at">prog =</span> <span class="st">&quot;stan&quot;</span>, <span class="at">parallel =</span> T, <span class="at">Xhisto =</span> proj.data, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nchains =</span> <span class="dv">2</span>, <span class="at">nthin =</span> <span class="dv">10</span>, <span class="at">niter =</span> <span class="dv">1000</span>, <span class="at">R =</span> toydata<span class="sc">$</span>wlu<span class="sc">$</span>Q)</span></code></pre></div>
<p>First we must convert the stanfit object to an mcmc.list. In this step we have loaded a stanfit object that is available in the package (with more iterations and chains than in the example above). We can do this using the function <code>coda.obj()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;stanfit&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>coda.plt <span class="ot">&lt;-</span> <span class="fu">coda.obj</span>(stanfit)</span></code></pre></div>
<p>We can plot the posterior density of the likelihood:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">postdens</span>(coda.plt, <span class="at">Y =</span> toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y, <span class="at">D =</span> toydata<span class="sc">$</span>wlu<span class="sc">$</span>D, <span class="at">chain =</span> <span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(post, <span class="at">main =</span> <span class="st">&quot;Histogram of the posterior density&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also plot the individual projections on the plane spanned by the estimated latent factors, with <span class="math inline">\(90 \%\)</span> uncertainty regions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>beta.res <span class="ot">&lt;-</span> <span class="fu">visbeta</span>(coda.plt, toydata<span class="sc">$</span>Y.simul<span class="sc">$</span>Y, toydata<span class="sc">$</span>wlu<span class="sc">$</span>D, <span class="at">chain =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">quant =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_path</span>(<span class="at">data =</span> beta.res<span class="sc">$</span>contour.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> ind)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> beta.res<span class="sc">$</span>mean.df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> ind)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Convex hull of HMC estimates of the scores&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
